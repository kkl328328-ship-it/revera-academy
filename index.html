<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì „ê³µíƒìƒ‰ê²€ì‚¬ (REVERA-ê³ ë“±ìš©)</title>
    <style>
        :root { --navy: #1a2a44; --light-navy: #f0f3f7; --border: #d1d5db; }
        body { font-family: 'Malgun Gothic', sans-serif; background: #f4f4f4; display: flex; flex-direction: column; align-items: center; padding: 20px; color: #333; margin: 0; }
        .container { width: 100%; max-width: 950px; background: white; border: 2px solid var(--navy); border-radius: 12px; padding: 30px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 100px; }
        .header { background: var(--navy); color: white; padding: 20px; text-align: center; border-radius: 50px; margin-bottom: 25px; font-weight: bold; font-size: 1.4rem; }
        .page { display: none; } .active { display: block; }
        .info-box { background: var(--light-navy); border-left: 5px solid var(--navy); padding: 18px; margin-bottom: 25px; font-size: 0.95rem; line-height: 1.7; color: #1a2a44; }
        .input-group { margin-bottom: 15px; text-align: left; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .input-group input, .input-group select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 25px; }
        th { background: #eee; padding: 12px; border: 1px solid var(--border); font-size: 0.9rem; color: var(--navy); position: sticky; top: 0; z-index: 5; }
        td { border: 1px solid var(--border); padding: 12px; text-align: center; font-size: 0.95rem; }
        .job-desc-table td { text-align: left; padding: 8px 15px; border: 1px solid #eee; background: #fafafa; font-size: 0.85rem;}
        .q-text { text-align: left; padding: 12px 20px; }
        .active-row { background-color: #eef2ff; outline: 2px solid var(--navy); }
        .btn-box { display: flex; justify-content: center; gap: 15px; margin-top: 30px; }
        button { padding: 15px 45px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; background: var(--navy); font-size: 1rem; }
        .progress-container { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 2px solid var(--navy); padding: 15px; text-align: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 100; }
        .progress-bar-bg { width: 80%; max-width: 700px; height: 12px; background: #eee; border-radius: 10px; margin: 8px auto; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: var(--navy); width: 0%; transition: width 0.3s ease; }
        .help-text { font-size: 0.85rem; color: #d9534f; margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">ğŸ“ ì „ê³µíƒìƒ‰ê²€ì‚¬ (REVERA-ê³ ë“±ìš©)</div>

    <div id="p0" class="page active">
        <div class="info-box"><b>[ìˆ˜í—˜ì ì •ë³´]</b> ëª¨ë“  ì •ë³´ë¥¼ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.</div>
        <div class="input-group"><label>ì´ë¦„:</label><input type="text" id="name"></div>
        <div class="input-group">
            <label>ì„±ë³„:</label>
            <select id="gender">
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ë‚¨">ë‚¨ì„±</option>
                <option value="ì—¬">ì—¬ì„±</option>
            </select>
        </div>
        <div class="input-group">
            <label>ê´€ì‹¬ ê³„ì—´ (ì˜ˆ: ì¸ë¬¸, ì‚¬íšŒ, ê³µí•™, ìì—°, ì˜ˆì²´ëŠ¥, ì˜ì•½, êµìœ¡, ìƒí™œê³¼í•™ ë“±):</label>
            <input type="text" id="interest" placeholder="ê´€ì‹¬ ê³„ì—´ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        <div class="input-group"><label>í•™êµ:</label><input type="text" id="school"></div>
        <div class="input-group"><label>í•™ë…„:</label><input type="number" id="grade"></div>
        <div class="input-group"><label>ì´ë©”ì¼ ì£¼ì†Œ:</label><input type="email" id="email"></div>
        <div class="input-group">
            <label>í•¸ë“œí° ë²ˆí˜¸:</label>
            <input type="tel" id="phone" placeholder="010-0000-0000">
            <div class="help-text">â€» í•œêµ­ í•¸ë“œí° ë²ˆí˜¸ê°€ ì—†ìœ¼ë©´ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ì£¼ì„¸ìš”.</div>
        </div>
        <div class="btn-box"><button onclick="checkP0()">ë‹¤ìŒ ë‹¨ê³„</button></div>
    </div>

    <div id="p1" class="page">
        <div class="info-box">
            <b>[í¬ë§ì§ì—…]</b><br>
            ìœ„ì—ì„œ ì„ ì •í•œ 5ê°œì˜ ì§ì—…ì— ëŒ€í•´ì„œ ê°€ì¥ í¬ë§í•˜ëŠ” ìˆœìœ„(1ìˆœìœ„) ë¶€í„° ê°€ì¥ ì ê²Œ í¬ë§í•˜ëŠ” ìˆœìœ„(5ìˆœìœ„)ê¹Œì§€ ìˆœìœ„ë¥¼ ì •í•´ì„œ í•´ë‹¹ ì§ì—…ì˜ ë²ˆí˜¸ì— ì²´í¬í•´ì£¼ì„¸ìš”.
        </div>
        <table class="job-desc-table">
            <tr><td><b>(ê°€)</b> ê¸°ê³„ë‚˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì§ì—…</td><td><b>(ë‚˜)</b> ì‹ ì²´ì  ê¸°ìˆ ì´ë‚˜ ìš´ë™ ëŠ¥ë ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
            <tr><td><b>(ë‹¤)</b> ìƒˆë¡œìš´ ê²ƒì„ ì•Œì•„ë‚´ê¸° ìœ„í•˜ì—¬ íƒêµ¬í•˜ëŠ” ì§ì—…</td><td><b>(ë¼)</b> ì—°êµ¬ëŠ¥ë ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
            <tr><td><b>(ë§ˆ)</b> ì°½ì˜ì ìœ¼ë¡œ ë¬´ì—‡ì¸ê°€ë¥¼ í‘œí˜„í•˜ëŠ” ì§ì—…</td><td><b>(ë°”)</b> ì˜ˆìˆ ì  ì¬ëŠ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
            <tr><td><b>(ì‚¬)</b> ë‹¤ë¥¸ ì‚¬ëŒì„ ë„ì™€ì£¼ê±°ë‚˜ ê°€ë¥´ì¹˜ëŠ” ì§ì—…</td><td><b>(ì•„)</b> ë‹¤ë¥¸ ì‚¬ëŒì„ ëŒë³´ëŠ” ëŠ¥ë ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
            <tr><td><b>(ì)</b> ì‚¬ëŒë“¤ì„ ê´€ë¦¬í•˜ê±°ë‚˜ ì´ëŒì–´ê°€ëŠ” ì§ì—…</td><td><b>(ì°¨)</b> ì¼ì„ ê³„íší•˜ê³  ì¶”ì§„í•˜ëŠ” ëŠ¥ë ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
            <tr><td><b>(ì¹´)</b> ì •ë³´ë‚˜ ë°ì´í„°ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì§ì—…</td><td><b>(íƒ€)</b> ê·œì¹™ì— ë”°ë¼ ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ëŠ¥ë ¥ì„ í™œìš©í•˜ëŠ” ì§ì—…</td></tr>
        </table>
        <table id="rank-table"></table>
        <div class="btn-box"><button style="background:#666" onclick="go(0)">ì´ì „</button><button onclick="checkP1()">ì„¤ë¬¸ ì‹œì‘ (í™œë™)</button></div>
    </div>

    <div id="survey-pages"></div>
</div>

<div class="progress-container" id="progress-container" style="display:none;">
    <div class="progress-text">í˜„ì¬ ì§„í–‰ë„: <span id="percent">0</span>% (<span id="count">0</span>/264)</div>
    <div class="progress-bar-bg"><div class="progress-bar-fill" id="bar"></div></div>
</div>

<script>
    const questionsText = [
        "ëª©ê³µì— ëŒ€í•œ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","ì •ë¹„ì‚¬ê°€ ë˜ê¸° ìœ„í•œ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","ì „ìì œí’ˆì„ ìˆ˜ë¦¬í•œë‹¤.","ìë™ì°¨ë¥¼ ìˆ˜ë¦¬í•œë‹¤.","ê¸°ê³„ë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ ìˆ˜ë¦¬í•œë‹¤.","ì¤‘ì¥ë¹„ ê¸°ê³„ë‚˜ ì¥ë¹„ë¥¼ ìš´ì „í•œë‹¤.","ê¸°ìˆ  êµìœ¡ì— ê´€í•œ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","í›Œë¥­í•œ ì •ë¹„ì‚¬ë‚˜ ê¸°ìˆ ìì™€ ì¼í•œë‹¤.","ì „ê¸° ì¥ë¹„ë¥¼ ì„¤ì¹˜í•œë‹¤.","ì‹íƒì„ ìˆ˜ë¦¬í•œë‹¤.","ê¸ˆì† ê°€ê³µì´ë‚˜ ê¸°ê³„ê³µêµ¬ë¥¼ ì´ìš©í•œë‹¤.","ê³µêµ¬ë¥¼ ê°€ì§€ê³  ì‘ì—…ì„ í•œë‹¤.","ë¬¼ê±´ì„ ì œì‘í•œë‹¤.","ì‘ì€ ë„êµ¬ë‚˜ ì—°ì¥ì„ ê°€ì§€ê³  ì‘ì—…ì„ í•œë‹¤.","ê³¼í•™ ì„œì ì´ë‚˜ ì¡ì§€ë¥¼ ì½ëŠ”ë‹¤.","ì—°êµ¬ì†Œë‚˜ ì‹¤í—˜ì‹¤ì—ì„œ ì¼í•œë‹¤.","ê³¼í•™ ì´ë¡ ì„ ê³µë¶€í•œë‹¤.","ë¬¼ë¦¬í•™ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ìˆ˜í•™ì„ ì ìš©í•œë‹¤.","ê³¼í•™ í”„ë¡œì íŠ¸ì— ì°¸ì—¬í•œë‹¤.","í™”í•™ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","ìƒë¬¼í•™ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","í•™ë¬¸ì  ë˜ëŠ” ê¸°ìˆ ì  ë¬¸ì œë¥¼ ì—°êµ¬í•œë‹¤.","ê³¼í•™ ì „ì‹œê´€ì„ ë°©ë¬¸í•œë‹¤.","ë³µí•©í•œ ë¬¸ì œì— ëŒ€í•œ í•´ê²°ì±…ì„ ì°¾ëŠ”ë‹¤.","ì—°êµ¬ì„¤ê³„ë¥¼ í•œë‹¤.","ì‹¤í—˜ì„ í•œë‹¤.","ë¬¸ì œì˜ ì›ì¸ì„ ì¡°ì‚¬í•œë‹¤.","ì†Œì„¤ì´ë‚˜ ê·¹ë³¸ì„ ì“´ë‹¤.","ì¬ëŠ¥ ìˆëŠ” í™”ê°€ë‚˜ ì‘ê°€, ì¡°ê°ê°€ì™€ ì¼í•œë‹¤.","ìŒì•…ì„ ì‘ê³¡í•˜ê±°ë‚˜ í¸ê³¡í•œë‹¤.","ìŠ¤ì¼€ì¹˜ë¥¼ í•˜ê±°ë‚˜ ê·¸ë¦¼ì„ ê·¸ë¦°ë‹¤.","ê°€êµ¬, ì˜ìƒ, í¬ìŠ¤í„° ë“±ì„ ë””ìì¸í•œë‹¤.","ì•…ê¸°ë¥¼ ì—°ì£¼í•œë‹¤.","ì´ˆìƒí™”ë¥¼ ê·¸ë¦¬ê±°ë‚˜ ì‚¬ì§„ì„ ì°ëŠ”ë‹¤.","ì‹œë¥¼ ì½ê±°ë‚˜ ì“´ë‹¤.","ë¯¸ìˆ ì´ë‚˜ ë””ìì¸ì— ëŒ€í•œ ìˆ˜ì—…ì„ ë“£ëŠ”ë‹¤.","ì¡ì§€ë‚˜ ì‹ ë¬¸ì— ì›ê³ ë¥¼ ì¨ì„œ ë³´ë‚¸ë‹¤.","ì¡ì§€ë¥¼ í¸ì§‘í•œë‹¤.","ê·¸ë˜í”½ ì‘í’ˆì„ ë§Œë“ ë‹¤.","ë¯¸ìˆ ê´€ì„ ë°©ë¬¸í•œë‹¤.","ì½”ë¯¸ë””ë‚˜ ì—°ê·¹ì— ì°¸ì—¬í•˜ë©° ì—°ê¸°í•œë‹¤.","ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ ì½ëŠ” ë²•ì„ ê°€ë¥´ì³ì¤€ë‹¤.","ì •ì‹ ì ìœ¼ë¡œ ì–´ë ¤ì›€ì„ ê²ªëŠ” ì‚¬ëŒë“¤ì„ ë„ì™€ì¤€ë‹¤.","ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ê°€ë¥´ì¹˜ëŠ” ì¼ì„ í•œë‹¤.","ë‹¤ë¥¸ ì‚¬ëŒë“¤ì„ ìœ„í•´ ë´‰ì‚¬í™œë™ì„ í•œë‹¤.","ì‚¬ëŒë“¤ì˜ ê³ ë¯¼ì„ ë“¤ì–´ì£¼ê³  ì¡°ì–¸ì„ í•´ì¤€ë‹¤.","ìƒˆë¡œìš´ ì‚¬ëŒë“¤ì„ ë§Œë‚˜ëŠ” ê²ƒì„ ì¦ê¸´ë‹¤.","ì§€ì—­ ì‚¬íšŒ í–‰ì‚¬ì— ì°¸ì—¬í•œë‹¤.","ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ë³µì§€ì— ê´€ì‹¬ì„ ê°–ëŠ”ë‹¤.","ì²­ì†Œë…„ ë‹¨ì²´ì—ì„œ í™œë™í•œë‹¤.","ì‚¬ëŒë“¤ì—ê²Œ ì¹œì ˆí•˜ê²Œ ëŒ€í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤.","ë‹¤ë¥¸ ì‚¬ëŒì˜ ê°ì •ì„ ì˜ ì´í•´í•œë‹¤.","ì‚¬ëŒë“¤ì„ ë•ëŠ” ì „ë¬¸ì ì¸ ê¸°ìˆ ì„ ë°°ìš´ë‹¤.","ë³‘ì›ì´ë‚˜ ë³µì§€ì‹œì„¤ì—ì„œ ìì›ë´‰ì‚¬ë¥¼ í•œë‹¤.","ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•˜ë©° ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.","ì‚¬ëŒë“¤ì—ê²Œ ì˜í–¥ë ¥ì„ í–‰ì‚¬í•œë‹¤.","ìì‹ ì˜ ì‚¬ì—…ì„ ìš´ì˜í•´ë³´ê³  ì‹¶ë‹¤.","ì‚¬ëŒë“¤ì„ ì´ëŒê³  ëª©í‘œë¥¼ ë‹¬ì„±í•œë‹¤.","ë¬´ì—‡ì¸ê°€ë¥¼ íŒë§¤í•˜ê±°ë‚˜ í™ë³´í•˜ëŠ” ì¼ì„ í•œë‹¤.","íšŒì˜ë‚˜ ëª¨ì„ì„ ì£¼ë„í•œë‹¤.","ê²½ì œë‚˜ ë¹„ì¦ˆë‹ˆìŠ¤ì— ê´€í•œ ì¡ì§€ë¥¼ ì½ëŠ”ë‹¤.","ê²½ìŸì ì¸ ìƒí™©ì—ì„œ ì¼í•˜ëŠ” ê²ƒì„ ì¦í‚¨ë‹¤.","ì¤‘ìš”í•œ ê²°ì •ì„ ë‚´ë¦¬ëŠ” ìœ„ì¹˜ì— ìˆê³  ì‹¶ë‹¤.","ì„±ê³µí•œ ê¸°ì—…ê°€ë“¤ì„ ë§Œë‚˜ëŠ” ê²ƒì„ ì¢‹ì•„í•œë‹¤.","ì‚¬ëŒë“¤ì—ê²Œ ë™ê¸°ë¥¼ ë¶€ì—¬í•˜ëŠ” ì—°ì„¤ì„ í•œë‹¤.","ìì‹ ì˜ ì•„ì´ë””ì–´ë¡œ ì‚¬ëŒë“¤ì„ ì„¤ë“í•œë‹¤.","ì •ì¹˜ë‚˜ ê²½ì˜ ë¶„ì•¼ì— ê´€ì‹¬ì´ ë§ë‹¤.","ëª©í‘œë¥¼ ìœ„í•´ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í˜‘ìƒí•œë‹¤.","ë‹¨ì²´ì˜ ë¦¬ë”ê°€ ë˜ì–´ ì¡°ì§ì„ ì´ëˆë‹¤.","ì‚¬ë¬´ì‹¤ì—ì„œ ì„œë¥˜ë¥¼ ì •ë¦¬í•œë‹¤.","ê¸°ë¡ì„ ì •í™•í•˜ê³  ì„¸ë°€í•˜ê²Œ ìœ ì§€í•œë‹¤.","ì»´í“¨í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤.","ê·œì¹™ê³¼ ì ˆì°¨ë¥¼ ì§€í‚¤ëŠ” ì¼ì„ ì„ í˜¸í•œë‹¤.","ê³„íší‘œì— ë”°ë¼ ì²´ê³„ì ìœ¼ë¡œ ì¼í•œë‹¤.","ì˜ˆì‚°ì„ ì„¸ìš°ê³  ëˆì„ ê´€ë¦¬í•œë‹¤.","ëª…í™•í•œ ì§€ì¹¨ì´ ìˆëŠ” ì¼ì„ ì¢‹ì•„í•œë‹¤.","ìˆ«ìë¥¼ ê³„ì‚°í•˜ê±°ë‚˜ í†µê³„ë¥¼ ë‚¸ë‹¤.","ì •ë³´ë¥¼ ë¶„ë¥˜í•˜ê³  íŒŒì¼ë§í•œë‹¤.","ì •í•´ì§„ ì‹œê°„ ë‚´ì— ê³¼ì œë¥¼ ì™„ìˆ˜í•œë‹¤.","ì„¸ë¶€ì ì¸ ì‚¬í•­ê¹Œì§€ ê¼¼ê¼¼í•˜ê²Œ ì±™í‚¨ë‹¤.","ì •ë¦¬ì •ëˆì„ ì˜ í•˜ëŠ” í¸ì´ë‹¤.","í‘œë‚˜ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” ì¼ì„ ì¦ê¸´ë‹¤.","ì‚¬ë¬´ ê¸°ê¸°ë¥¼ ëŠ¥ìˆ™í•˜ê²Œ ë‹¤ë£¬ë‹¤.",
        "ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•œ ìˆ˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.","ê¸°ê³„ì˜ ì‘ë™ ì›ë¦¬ë¥¼ ì˜ ì´í•´í•œë‹¤.","ê°€êµ¬ ì¡°ë¦½ì´ë‚˜ ëª©ê³µ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.","ë¼ë””ì˜¤ë‚˜ ì „ìê¸°ê¸° ìˆ˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.","ì „ê¸° ë°°ì„ ì´ë‚˜ ì„¤ë¹„ ì‘ì—…ì„ ì´í•´í•œë‹¤.","ë„ë©´ì„ ë³´ê³  ë¬¼ê±´ì„ ë§Œë“ ë‹¤.","ì •ë°€í•œ ê¸°ê³„ ì¡°ì‘ì„ í•  ìˆ˜ ìˆë‹¤.","ìˆ˜ë™ ê³µêµ¬ë¥¼ ëŠ¥ìˆ™í•˜ê²Œ ì‚¬ìš©í•œë‹¤.","ì¸¡ëŸ‰ ê¸°êµ¬ë‚˜ ì¥ë¹„ë¥¼ ë‹¤ë£° ìˆ˜ ìˆë‹¤.","ê¸°ìˆ ì ì¸ ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì´ ìˆë‹¤.","ì¤‘ì¥ë¹„ë‚˜ ì°¨ëŸ‰ì˜ ê¸°ë³¸ ì •ë¹„ê°€ ê°€ëŠ¥í•˜ë‹¤.","ê¸ˆì†ì´ë‚˜ ì¬ë£Œ ê°€ê³µì„ í•  ìˆ˜ ìˆë‹¤.","ê³µêµ¬ì˜ ëª…ì¹­ê³¼ ìš©ë„ë¥¼ ì •í™•íˆ ì•ˆë‹¤.","ì†ì¬ì£¼ê°€ ì¢‹ë‹¤ëŠ” í‰ê°€ë¥¼ ë°›ëŠ”ë‹¤.","ê³¼í•™ ì‹¤í—˜ì„ ì„¤ê³„í•˜ê³  ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.","ìˆ˜í•™ì  ê³µì‹ì´ë‚˜ í†µê³„ë¥¼ ì˜ í™œìš©í•œë‹¤.","ë…¼ë¦¬ì ìœ¼ë¡œ ì›ì¸ì„ ë¶„ì„í•œë‹¤.","ì •ë°€ ì¸¡ì • ì¥ë¹„ë¥¼ ì˜ ë‹¤ë£¬ë‹¤.","ê³¼í•™ ì´ë¡ ì„ ë¹ ë¥´ê²Œ ìŠµë“í•œë‹¤.","í”„ë¡œê·¸ë˜ë°ì´ë‚˜ ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•œë‹¤.","í™”í•™ ê¸°í˜¸ë‚˜ ìƒë¬¼ ì§€ì‹ì´ í’ë¶€í•˜ë‹¤.","ê°€ì„¤ì„ ì„¸ìš°ê³  ê²€ì¦í•˜ëŠ” ëŠ¥ë ¥ì´ ìˆë‹¤.","ë³µì¡í•œ ë°ì´í„°ë¥¼ í•´ì„í•  ìˆ˜ ìˆë‹¤.","í•™ìˆ  ìë£Œë¥¼ ì½ê³  ìš”ì•½í•œë‹¤.","ì‹¤í—˜ì‹¤ ì¥ë¹„ë¥¼ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•œë‹¤.","ì—°êµ¬ ë³´ê³ ì„œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì‘ì„±í•œë‹¤.","ë°ì´í„°ì˜ ìˆ˜ì¹˜ ì˜¤ë¥˜ë¥¼ ì˜ ì°¾ì•„ë‚¸ë‹¤.","ì§€ì  í˜¸ê¸°ì‹¬ì´ ê°•í•˜ê³  íƒêµ¬ì ì´ë‹¤.","ì•…ê¸°ë¥¼ ì—°ì£¼í•˜ê±°ë‚˜ ë…¸ë˜ë¥¼ ì˜í•œë‹¤.","ë…ì°½ì ì¸ ê¸€ì´ë‚˜ ì‹œë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.","ê·¸ë¦¼ì´ë‚˜ ì¡°ê°ìœ¼ë¡œ ê°ì •ì„ í‘œí˜„í•œë‹¤.","ê³µì—°ì´ë‚˜ ì—°ê·¹ì—ì„œ ì—°ê¸°ë¥¼ ì˜í•œë‹¤.","ì˜ìƒì´ë‚˜ ì¸í…Œë¦¬ì–´ë¥¼ ë””ìì¸í•œë‹¤.","ì‚¬ì§„ì´ë‚˜ ì˜ìƒì„ ê°ê°ì ìœ¼ë¡œ ì°ëŠ”ë‹¤.","ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ ëŠì„ì—†ì´ ë‚¸ë‹¤.","ì˜ˆìˆ  ì‘í’ˆì˜ ë¯¸ì  ê°€ì¹˜ë¥¼ ì˜ ì•ˆë‹¤.","ë‹¤ì–‘í•œ ìƒ‰ì±„ë¥¼ ì¡°í™”ë¡­ê²Œ ì“´ë‹¤.","ì‚¬ëŒë“¤ì˜ ìƒìƒë ¥ì„ ìê·¹í•œë‹¤.","ë‚¨ë‹¤ë¥¸ ì˜ˆìˆ ì  ê°ê°ì´ ìˆë‹¤ëŠ” ë§ì„ ë“£ëŠ”ë‹¤.","ë¬´ëŒ€ ì—°ì¶œì´ë‚˜ ê¸°íšì„ í•  ìˆ˜ ìˆë‹¤.","ì°½ì‘ í™œë™ì„ í•  ë•Œ ëª°ì…ë„ê°€ ë†’ë‹¤.","ìì‹ ë§Œì˜ ë…íŠ¹í•œ ìŠ¤íƒ€ì¼ì„ ê°€ì§€ê³  ìˆë‹¤.","íƒ€ì¸ì˜ ê³ ë¯¼ì„ ì˜ ë“¤ì–´ì£¼ê³  ì¡°ì–¸í•œë‹¤.","ê°€ë¥´ì¹˜ëŠ” ì¼ì„ í•  ë•Œ ë³´ëŒì„ ëŠë‚€ë‹¤.","ì‚¬ëŒë“¤ê³¼ ì›ë§Œí•œ ê´€ê³„ë¥¼ ìœ ì§€í•œë‹¤.","ê°ˆë“± ìƒí™©ì„ ì¤‘ì¬í•˜ê³  í™”í•´ì‹œí‚¨ë‹¤.","ë´‰ì‚¬ í™œë™ì˜ ê°€ì¹˜ë¥¼ ì‹¤ì²œí•œë‹¤.","ëˆ„êµ°ê°€ë¥¼ ë•ëŠ” ê¸°ìˆ ì„ ë¹¨ë¦¬ ë°°ìš´ë‹¤.","ì²˜ìŒ ë³´ëŠ” ì‚¬ëŒê³¼ ëŒ€í™”ë¥¼ ì˜ ì´ëˆë‹¤.","ì‹¬ë¦¬ì  ì§€ì›ì´ë‚˜ ìƒë‹´ì„ í•  ìˆ˜ ìˆë‹¤.","í˜‘ë ¥í•˜ì—¬ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ” ê²ƒì„ ì˜í•œë‹¤.","íƒ€ì¸ì˜ ì„±ì¥ì„ ë•ëŠ” ëŠ¥ë ¥ì´ ìˆë‹¤.","ì‚¬íšŒì  ë¬¸ì œì— í—Œì‹ ì ì´ë‹¤.","ëŒ€í™”ë¥¼ í†µí•´ ì‹ ë¢°ë¥¼ ìŒ“ëŠ”ë‹¤.","ì‚¬ëŒë“¤ì˜ ê°ì •ì„ ì„¬ì„¸í•˜ê²Œ íŒŒì•…í•œë‹¤.","ì¡°ì§ ë‚´ ë¶„ìœ„ê¸°ë¥¼ í™”ê¸°ì• ì• í•˜ê²Œ ë§Œë“ ë‹¤.","íŒ€ì„ ì´ëŒê³  ëª©í‘œë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤.","ì‚¬ëŒë“¤ì„ ì„¤ë“í•˜ì—¬ ë‚´ í¸ìœ¼ë¡œ ë§Œë“ ë‹¤.","ì‚¬ì—…ì  ê¸°íšŒë¥¼ í¬ì°©í•˜ëŠ” ëŠ¥ë ¥ì´ ìˆë‹¤.","ê²½ìŸì ì¸ ìƒí™©ì„ ì¦í‚¨ë‹¤.","ê²°ì •ì„ ë‚´ë¦´ ë•Œ ê²°ë‹¨ë ¥ì´ ìˆë‹¤.","ì¡°ì§ì˜ ë¹„ì „ì„ ì œì‹œí•˜ê³  ì§€íœ˜í•œë‹¤.","ì¬ë¬´ì  íë¦„ì´ë‚˜ íˆ¬ìë¥¼ ë¶„ì„í•œë‹¤.","ëŒ€ì¤‘ ì•ì—ì„œ ìì‹  ìˆê²Œ ë°œí‘œí•œë‹¤.","ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ê¸°íší•˜ê³  ì¶”ì§„í•œë‹¤.","ë§ˆì¼€íŒ…ì´ë‚˜ ì˜ì—… ì „ëµì„ ì„¸ìš¸ ìˆ˜ ìˆë‹¤.","ë¦¬ë”ë¡œì„œ ì±…ì„ê°ì„ ê°€ì§€ê³  í–‰ë™í•œë‹¤.","í˜‘ìƒì„ ìœ ë¦¬í•˜ê²Œ ì´ë„ëŠ” ìˆ˜ì™„ì´ ìˆë‹¤.","ì‚¬ëŒë“¤ì˜ ë™ê¸°ë¥¼ ìœ ë°œí•˜ëŠ” ëŠ¥ë ¥ì´ ìˆë‹¤.","ëŒ€ê·œëª¨ ì¡°ì§ì„ ê´€ë¦¬í•œ ê²½í—˜ì´ ìˆë‹¤.","ë°©ëŒ€í•œ ìë£Œë¥¼ ê¸°ì¤€ì— ë”°ë¼ ì •ë¦¬í•œë‹¤.","ì •í•´ì§„ ê·œì¹™ê³¼ ì ˆì°¨ë¥¼ ì§€í‚¨ë‹¤.","ë¬¸ì„œì˜ ì˜¤íƒ€ë‚˜ ì˜¤ë¥˜ë¥¼ ì˜ ì°¾ì•„ë‚¸ë‹¤.","íšŒê³„ ì¥ë¶€ë‚˜ ê°€ê³„ë¶€ë¥¼ ì •í™•íˆ ì“´ë‹¤.","ì‚¬ë¬´ ê¸°ê¸°ë‚˜ ì»´í“¨í„°ë¥¼ ì˜ í™œìš©í•œë‹¤.","ê³„íší‘œì— ë§ì¶° ì²´ê³„ì ìœ¼ë¡œ ì¼í•œë‹¤.","ì˜ˆì‚°ì„ ì„¸ìš°ê³  ëˆì„ ê´€ë¦¬í•œë‹¤.","ì •ë³´ë¥¼ ë¶„ë¥˜í•˜ê³  íŒŒì¼ë§í•œë‹¤.","ë§ˆê° ê¸°í•œì„ ì² ì €íˆ ì§€í‚¨ë‹¤.","ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ì— ëŠ¥ìˆ™í•˜ë‹¤.","ì •ë¦¬ì •ëˆì„ ìŠµê´€ì ìœ¼ë¡œ ì˜í•œë‹¤.","ë²•ì  ê·œì •ì´ë‚˜ ë§¤ë‰´ì–¼ì„ ì¤€ìˆ˜í•œë‹¤.","ë°˜ë³µ ì—…ë¬´ë„ ëˆê¸° ìˆê²Œ ìˆ˜í–‰í•œë‹¤.","í–‰ì • ì—…ë¬´ ì²˜ë¦¬ ëŠ¥ë ¥ì´ ìš°ìˆ˜í•˜ë‹¤.",
        "í•­ê³µê¸° ì •ë¹„ì‚¬","í† ëª© ê¸°ì‚¬","ì „ê¸° ê³µí•™ì","ì¡°ê²½ ê¸°ìˆ ì","ê¸°ê³„ ì„¤ê³„ì‚¬","ìë™ì°¨ ìˆ˜ë¦¬ì›","ì¤‘ì¥ë¹„ ìš´ì „ì‚¬","ì»´í“¨í„° ì¡°ë¦½ì›","ìš©ì ‘ ê¸°ìˆ ì","ë†ê¸°ê³„ ê´€ë¦¬ì‚¬","ê°€êµ¬ ì œì‘ì","í†µì‹  ì„¤ë¹„ ê¸°ì‚¬","ì¸¡ëŸ‰ ê¸°ì‚¬","ì„ ë°• ì •ë¹„ì›","ìƒë¬¼í•™ì","í™”í•™ ì—°êµ¬ì›","ì²œë¬¸í•™ì","ì˜í•™ ë¶„ì„ê°€","í•´ì–‘ ê³¼í•™ì","ì‹œìŠ¤í…œ ë¶„ì„ê°€","ì§€ì§ˆí•™ì","ê³ ê³ í•™ ì „ë¬¸ê°€","ìˆ˜í•™ì","ë¬¼ë¦¬í•™ì","ì•½ë¦¬í•™ì","ì¸ë¥˜í•™ ì—°êµ¬ì›","ê¸°ìƒ ì˜ˆë³´ê´€","ìœ ì „ ê³µí•™ì","ì†Œì„¤ê°€","ê³µì—° ì—°ì¶œê°€","ê·¸ë˜í”½ ë””ìì´ë„ˆ","íŒ¨ì…˜ ëª¨ë¸","ìˆœìˆ˜ ë¯¸ìˆ ê°€","ì‘ê³¡ê°€","ë°°ìš°","ì‚¬ì§„ ì‘ê°€","ì›¹íˆ° ì‘ê°€","ì¸í…Œë¦¬ì–´ ë””ìì´ë„ˆ","ë§Œí™”ê°€","ë¬´ëŒ€ ë¯¸ìˆ ê°€","ì‹œì¸","ê´‘ê³  ì¹´í”¼ë¼ì´í„°","ì‚¬íšŒ ë³µì§€ì‚¬","íŠ¹ìˆ˜ êµìœ¡ êµì‚¬","ì§ì—… ìƒë‹´ì‚¬","ê°„í˜¸ì‚¬","ë¬¼ë¦¬ ì¹˜ë£Œì‚¬","ìœ ì¹˜ì› êµì‚¬","ì²­ì†Œë…„ ì§€ë„ì‚¬","ì„±ì§ì","ì–¸ì–´ ì¹˜ë£Œì‚¬","í•™êµ ìƒë‹´ì‚¬","ì˜ì–‘ì‚¬","í˜¸ìŠ¤í”¼ìŠ¤ ì „ë¬¸ê°€","êµ¬í˜¸ í™œë™ê°€","ì„ìƒ ì‹¬ë¦¬ì‚¬","ê¸°ì—… í™ë³´ ì „ë¬¸ê°€","ì •ì¹˜ì¸","íŒë§¤ ì±…ì„ì","ë¶€ë™ì‚° ì¤‘ê°œì¸","ì˜ì—… ê´€ë¦¬ì","ê´‘ê³  ê¸°íšì","ë¬´ì—­ ì „ë¬¸ê°€","í˜¸í…” ê´€ë¦¬ì","ë²•ë¥ ê°€","íˆ¬ì ë¶„ì„ê°€","ë³´í—˜ ê³„ë¦¬ì‚¬","í”„ë¡œì íŠ¸ ë§¤ë‹ˆì €","ì™¸êµê´€","ì¤‘ì†Œê¸°ì—… ê²½ì˜ì¸","ì„¸ë¬´ì‚¬","íšŒê³„ ê°ì‚¬ì›","ë„ì„œê´€ ì‚¬ì„œ","ì€í–‰ ì‚¬ë¬´ì›","í†µê³„ ë¶„ì„ê°€","ë²•ë¬´ì‚¬","ê¸°ë¡ë¬¼ ê´€ë¦¬ì‚¬","ì„¸ê´€ì›","ìš°í¸ ì‚¬ë¬´ì›","í’ˆì§ˆ ê´€ë¦¬ì","ë°ì´í„° ì…ë ¥ ìš”ì›","ì˜ˆì‚° ë¶„ì„ê°€","í–‰ì • ì„œê¸°","ë²•ì› ì„œê¸°ë³´",
        "ë‚˜ëŠ” ê¸°ê³„ì ì¸ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŠ¥ë ¥ì´ ìš°ìˆ˜í•˜ë‹¤.","ë‚˜ëŠ” ì‹ ì²´ì  ë¯¼ì²©ì„±ê³¼ ìš´ë™ ëŠ¥ë ¥ì´ ì¢‹ë‹¤.","ë‚˜ëŠ” ê³¼í•™ì ì¸ íƒêµ¬ì™€ ë¶„ì„ ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ë‹¤.","ë‚˜ëŠ” ìˆ˜í•™ì ì¸ ì¶”ë¡ ê³¼ ê³„ì‚° ëŠ¥ë ¥ì´ ìš°ìˆ˜í•˜ë‹¤.","ë‚˜ëŠ” ì°½ì˜ì ì¸ ì˜ˆìˆ  í‘œí˜„ ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ë‹¤.","ë‚˜ëŠ” ìŒì•…ì /ë¯¸ìˆ ì  ê°ê°ì´ ë§¤ìš° ë†’ë‹¤.","ë‚˜ëŠ” ë‚¨ì„ ê°€ë¥´ì¹˜ê³  ë•ëŠ” ì‚¬íšŒì  ëŠ¥ë ¥ì´ ìš°ìˆ˜í•˜ë‹¤.","ë‚˜ëŠ” íƒ€ì¸ì˜ ê°ì •ì„ ì´í•´í•˜ëŠ” ê³µê° ëŠ¥ë ¥ì´ ì¢‹ë‹¤.","ë‚˜ëŠ” ì‚¬ëŒë“¤ì„ ì´ë„ëŠ” ì§€ë„ë ¥(ë¦¬ë”ì‹­)ì´ ê°•í•˜ë‹¤.","ë‚˜ëŠ” ì„¤ë“ë ¥ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ì ì¸ ìˆ˜ì™„ì´ ë›°ì–´ë‚˜ë‹¤.","ë‚˜ëŠ” ì‚¬ë¬´ì ì¸ ê¼¼ê¼¼í•¨ê³¼ ì •ë¦¬ ëŠ¥ë ¥ì´ ìš°ìˆ˜í•˜ë‹¤.","ë‚˜ëŠ” ì •í™•í•œ ê³„ì‚°ê³¼ ì„¸ë¶€ ì‚¬í•­ í™•ì¸ ëŠ¥ë ¥ì´ ì¢‹ë‹¤."
    ];

    const sections = [
        { id: 2, title: "I. í™œë™", desc: "ê´€ì‹¬ì´ ìˆëŠ” í™œë™ì´ë©´ 1(Y), ì•„ë‹ˆë©´ 2(N)ì— ì²´í¬í•˜ì‹­ì‹œì˜¤.", start: 1, end: 84, type: 'binary' },
        { id: 3, title: "II. ì—­ëŸ‰", desc: "ë§Œì•½ ì´ í™œë™ì„ ì˜ í•  ìˆ˜ ìˆë‹¤ê³  ìƒê°ë˜ë©´ 1(Y), ì•„ë‹ˆë©´ 2(N)ì— ì²´í¬í•˜ì‹­ì‹œì˜¤.", start: 85, end: 168, type: 'binary' },
        { id: 4, title: "III. ì§ì—…", desc: "í¥ë¯¸ë¥¼ ëŠë¼ê±°ë‚˜ ì¢‹ì•„í•˜ëŠ” ì§ì—…ì´ë©´ 1(Y), ì•„ë‹ˆë©´ 2(N)ì— ì²´í¬í•˜ì‹­ì‹œì˜¤.", start: 169, end: 252, type: 'binary' },
        { id: 5, title: "IV. ìê¸°í‰ê°€", desc: "ë‹¤ë¥¸ ê°™ì€ ë‚˜ì´ì˜ ì¹œêµ¬ë“¤ì— ë¹„í•´ì„œ ìì‹ ì´ ì•„ë˜ì˜ ëŠ¥ë ¥ë“¤ì„ ì–¼ë§ˆë‚˜ ê°€ì§€ê³  ìˆëŠ”ì§€ ë¹„êµí•˜ì—¬ ìŠ¤ìŠ¤ë¡œ í‰ê°€í•´ì£¼ì„¸ìš”. (1: ë§¤ìš° ìš°ìˆ˜ ~~ 7: ë§¤ìš° ë¶€ì¡±)", start: 253, end: 264, type: 'score' }
    ];

    let currentGlobalIdx = 0;

    window.onload = () => {
        const rt = document.getElementById('rank-table');
        for(let i=1; i<=5; i++){
            let row = `<tr><td><b>${i}ìˆœìœ„</b></td><td style="text-align:left">`;
            ['ê°€','ë‚˜','ë‹¤','ë¼','ë§ˆ','ë°”','ì‚¬','ì•„','ì','ì°¨','ì¹´','íƒ€'].forEach(c => row += `<label style="margin-right:12px"><input type="radio" name="r${i}" value="${c}" onchange="preventDup(this,${i})"> (${c})</label>`);
            rt.innerHTML += row + `</td></tr>`;
        }

        const sp = document.getElementById('survey-pages');
        sections.forEach((sec, idx) => {
            let html = `<div id="p${sec.id}" class="page"><div class="info-box"><b>[${sec.title}]</b><br>${sec.desc}</div><table><thead><tr><th>ë¬¸í•­</th>`;
            if(sec.type === 'binary') html += `<th width="80">1(Y)</th><th width="80">2(N)</th></tr></thead><tbody>`;
            else html += `<th>1(ìš°ìˆ˜)</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7(ë¶€ì¡±)</th></tr></thead><tbody>`;

            for(let i = sec.start; i <= sec.end; i++){
                html += `<tr id="row-${i-1}"><td class="q-text">${i}. ${questionsText[i-1]}</td>`;
                const range = (sec.type === 'binary') ? 2 : 7;
                for(let r=1; r<=range; r++) html += `<td><input type="radio" name="q${i-1}" id="q${i-1}-${r}" onchange="updateProgress()"></td>`;
                html += `</tr>`;
            }
            html += `</tbody></table><div class="btn-box"><button style="background:#666" onclick="go(${sec.id-1})">ì´ì „</button><button onclick="${idx===3?'finish()':`checkSection(${sec.id},${sec.start-1},${sec.end-1})`}">${idx===3?'ìµœì¢… ì œì¶œ':'ë‹¤ìŒ ìœ í˜•ìœ¼ë¡œ'}</button></div></div>`;
            sp.innerHTML += html;
        });
    };

    function go(n) {
        document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
        document.getElementById(`p${n}`).classList.add('active');
        document.getElementById('progress-container').style.display=(n>=2)?'block':'none';
        window.scrollTo(0,0);
        if(n>=2) {
            currentGlobalIdx = sections.find(s=>s.id===n).start-1;
            document.querySelectorAll('tr').forEach(r=>r.classList.remove('active-row'));
            document.getElementById(`row-${currentGlobalIdx}`).classList.add('active-row');
        }
    }

    function checkP0() {
        // í•„ìˆ˜ í•„ë“œì—ì„œ 'phone' ì œì™¸
        const fields = ['name', 'gender', 'interest', 'school', 'grade', 'email'];
        for(let f of fields) if(!document.getElementById(f).value) return alert("í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        go(1);
    }

    function checkP1() {
        for(let i=1;i<=5;i++) if(!document.querySelector(`input[name="r${i}"]:checked`)) return alert(i+"ìˆœìœ„ë¥¼ ì„ íƒí•˜ì„¸ìš”.");
        go(2);
    }

    function checkSection(p, s, e) {
        for(let i=s; i<=e; i++) {
            let chk = false; for(let r=1; r<=7; r++) if(document.getElementById(`q${i}-${r}`)?.checked) chk = true;
            if(!chk) { alert((i+1)+"ë²ˆ ëˆ„ë½"); document.getElementById(`row-${i}`).scrollIntoView({behavior:'smooth', block:'center'}); return; }
        }
        go(p + 1);
    }

    function updateProgress() {
        let a=0; for(let i=0;i<264;i++){
            let c=false; for(let r=1;r<=7;r++) if(document.getElementById(`q${i}-${r}`)?.checked) c=true;
            if(c) a++;
        }
        let per=Math.floor((a/264)*100); document.getElementById('bar').style.width=per+"%";
        document.getElementById('percent').innerText=per; document.getElementById('count').innerText=a;
    }

    function preventDup(s,r) {
        for(let i=1;i<=5;i++) if(i!==r){ let o=document.querySelector(`input[name="r${i}"]:checked`); if(o&&o.value===s.value){alert("ì¤‘ë³µë˜ì—ˆìŠµë‹ˆë‹¤."); s.checked=false;}}
    }

    function finish() {
        const data = {
            name: document.getElementById('name').value, gender: document.getElementById('gender').value,
            interest: document.getElementById('interest').value, school: document.getElementById('school').value,
            grade: document.getElementById('grade').value, email: document.getElementById('email').value,
            phone: document.getElementById('phone').value, ranks: [], answers: []
        };
        for(let i=1; i<=5; i++) data.ranks.push(document.querySelector(`input[name="r${i}"]:checked`).value);
        for(let i=0; i<264; i++) {
            let val = ""; for(let r=1; r<=7; r++) if(document.getElementById(`q${i}-${r}`)?.checked) val = r;
            data.answers.push(val);
        }
        if(data.answers.includes("")) return alert("ëˆ„ë½ëœ ë¬¸í•­ì´ ìˆìŠµë‹ˆë‹¤.");

        const url = "https://script.google.com/macros/s/AKfycbziE4u5-cIBEjsCAqw58ts11aNtpMGEp26Xi8mZ9WClNjnstQyPD3C1Y_LeBD_WaC9r2A/exec"; 
        alert("ë°ì´í„° ì €ì¥ ì¤‘...");
        fetch(url, { method: 'POST', mode: 'no-cors', body: JSON.stringify(data) })
        .then(() => { alert("ì œì¶œ ì™„ë£Œ!"); location.reload(); });
    }

    document.addEventListener('keydown', (e) => {
        const active = document.querySelector('.page.active');
        if(!active || parseInt(active.id.slice(1)) < 2) return;
        const sec = sections.find(s => s.id === parseInt(active.id.slice(1)));
        if (currentGlobalIdx < sec.start - 1 || currentGlobalIdx > sec.end - 1) return;
        const key = parseInt(e.key);
        const max = (sec.type === 'binary') ? 2 : 7;
        if(key >= 1 && key <= max) {
            const rb = document.getElementById(`q${currentGlobalIdx}-${key}`);
            if(rb) {
                rb.checked = true; updateProgress();
                document.getElementById(`row-${currentGlobalIdx}`).classList.remove('active-row');
                if(currentGlobalIdx < sec.end - 1) {
                    currentGlobalIdx++;
                    const next = document.getElementById(`row-${currentGlobalIdx}`);
                    next.classList.add('active-row'); next.scrollIntoView({behavior:'smooth', block:'center'});
                }
            }
        }
    });
</script>
</body>
</html>
